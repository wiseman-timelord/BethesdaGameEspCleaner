# BethesdaGameEspCleaner
**Status:** Beta

### Description
A multi-threaded ESP cleaning utility similar to the concept of "P.A.C.T" for Fallout 4, but now for all AutoCleaner supported Bethesda games using xEdit's Auto-Clean. This tool automates the cleaning process using parallel instances of xEdit specifically made for relating game (ie TES4Edit for Oblivion), significantly reducing time and effort when working with large mod lists. For those whom may not know, this enables cleaning of Esps that one may have as part of a large mod collection, which in-turn prevents random, crashes and issues, from uncleaned mods. 

**Features:**
* 1–4 thread parallel cleaning using xEdit-AutoCleaner
* Auto-blacklist to skip recently cleaned ESPs
* Error logging and real-time progress
* Automatic xEdit setup on first run
* Designed for future multi-game support

### Preview
- In Dual-Thread mode (sensible number)...
```
===============================================================================
    Oblivion Esp Cleaner
===============================================================================

Using 2 thread(s) for processing
[OK] Blacklist maintenance complete
[OK] Found 134 ESP files
[OK] Loaded 85 blacklist entries
[OK] Processing 49 ESPs (skipped 85)
[OK] Task queue initialized with 49 tasks

Starting task queue processing with 2 thread(s)...
Monitoring thread progress...
Thread1 = 2, Thread2 = 0, Completed/Total = 2/49
Thread1 = 2, Thread2 = 2, Completed/Total = 4/49
Thread1 = 3, Thread2 = 2, Completed/Total = 5/49
Thread1 = 3, Thread2 = 3, Completed/Total = 6/49
Thread1 = 4, Thread2 = 3, Completed/Total = 7/49
Thread1 = 4, Thread2 = 4, Completed/Total = 8/49
Thread1 = 5, Thread2 = 4, Completed/Total = 9/49
Thread1 = 6, Thread2 = 4, Completed/Total = 10/49
Thread1 = 7, Thread2 = 4, Completed/Total = 11/49
...
```

### Structure:
- Program...
```
.\OblivionEspCleaner.bat
.\oec_installer.ps1
.\oec_program.ps1
.\oec_thread.ps1
```
- Additions After install.
```
.\oec_settings.psd1  # <-- Configuration File
.\TES4Edit*.7z  # <-- lateset TES4Edit expanded, folder contained moved.
.\Thread#\*  # <-- sequential folders with word thread for replication of AutoClean exe.
.\temp\*  <-- files generated by program, ie processing lists per thread.
```

### Installation & Instructions
``` 1. Download and Extract the BethesdaGameEspCleaner release into a subfolder of your game directory (e.g. `C:\Games\Oblivion\BethesdaGameEspCleaner\`).
2. Download the latest TES4Edit `.7z` from [Nexus Mods](https://www.nexusmods.com/oblivion/mods/11536) and place it in the same folder as the program files.
3. Ensure structure looks like:

   Oblivion\
   ├── Data\
   └── BethesdaGameEspCleaner\
       ├── BethesdaGameEspCleaner.bat
       ├── oec_installer.ps1
       ├── oec_program.ps1
       ├── oec_thread.ps1
       └── TES4Edit*.7z

4. Run Setup by launching the `.bat` file as Administrator → select option `2` to extract TES4Edit, set up thread folders, and generate config → choose 1–4 threads based on your system.
- It will download the portable `7za.exe` from the official `7z` site, in order to extract the `TES4Edit*.7z` file, obviously it needs to do that.
5. Start Cleaning by running the `.bat` again as Administrator or just having returned to the menu, (if you have second monitor put command prompt into it) then select option `1` to begin processing ESPs...
- There is occasionally a mod that will pause the TES4Edit-AutoClean page open (AutoClean would otherwise do that anyhow), but, if there is an "Ok" on the bottom right of AutoClean click that or if there is no "Ok" button then press the `[x]` in the top right.
6. Review Logs: `oec_blacklist.txt` (cleaned), `oec_errorlist.txt` (failures); temp files and thread folders are auto-managed. ```

### Notation
- This version is configured for **The Elder Scrolls IV: Oblivion**, but, can be adapted for and will be released on, other xEdit-Autoclean supported games like Skyrim, Fallout 3, and New Vegas.

### Warnings
- **Epilepsy** - Processing phase involves repeating open/close of full-screen tool."
